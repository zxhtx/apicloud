<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,initial-scale=1.0,width=device-width" />
  <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
  <title>Hello APP</title>
  <link rel="stylesheet" type="text/css" href="./css/api.css" />
  <style type="text/css">

</style>
</head>

<body class="wrap">

</body>
<script type="text/javascript" src="./script/api.js"></script>
<script type="text/javascript" src="./script/SHA1.js"></script>
<script type="text/javascript" src="./script/db.js"></script>
<script type="text/javascript">
  apiready = function() {
    WareTypeList();
    // initPushGeTui();
    initdb();

    api.openWin({
      name: 'main',
      url: './html/main.html',
      pageParam: {
        name: 'test'
      }
    });
  }
  function initdb(){
    $db.open();
  }

//   function initPushGeTui(){
//   var uzgetuisdk = api.require('pushGeTui');
//     uzgetuisdk.initialize(function(ret) {
//     var value = "";
//     switch (ret.type) {
//         case 'cid':
//             value = 'cid:' + ret.cid;
//             break;
//         case 'payload':
//             value = 'payload:' + ret.payload;
//             break;
//         case 'occurError':
//             value = 'occurError';
//             break;
//         case'onNotificationMessageClicked':
//           value = 'onNotificationMessageClicked' + ret.onNotificationMessageClicked
//           break;
//         case'onNotificationMessageArrived':
//           value = 'onNotificationMessageArrived' + ret.onNotificationMessageArrived
//           break;
//     }
// });

//  } 
function WareTypeList(){
  var WareTypeList=$api.getStorage('WareTypeList');
  if (!WareTypeList) {
   wareTypeList=[
   {
    "id": "56c80da883af652643474b6b",
    "name": "男鞋",
  },
  {
    "id": "56c80db78d04c83d3d1dedea",
    "name": "女鞋",
  },
  {
    "id": "56c80dc031da9e480de1cb49",
    "name": "男装",
  },
  {
    "id": "56c80dc383af652643474b6d",
    "name": "女装",
  },
  {
    "id": "5c6e5cc2d772329a6f2562dd",
    "name": "优惠购",
  },
  ];
}
getWareTypeList();
}
function getWareTypeList(){
 var now = Date.now();
      //5FB51794-FCDC-1FE9-19E0-xxxxxxxxxxxx换成自己appkey
      var appKey = SHA1("A6099267504667"+"UZ"+"8FC0173C-B395-B797-D516-7A6CD23939B3"+"UZ"+now)+"."+now

      var params={
        fields:{},
        where:{},
        skip:0,
        
      }
      params=$api.jsonToStr(params);
      api.ajax({
        url: 'http://d.apicloud.com/mcm/api/wareType?filter='+params,
        method: 'get',
        headers: {
          "X-APICloud-AppId": "A6099267504667",
          "X-APICloud-AppKey":   appKey
        },

      },function(ret, err){
        if (ret) {
         $api.setStorage('WareTypeList', ret);
       } else {
        // alert( err.msg );
      }
    });
    }



  </script>

  </html>
